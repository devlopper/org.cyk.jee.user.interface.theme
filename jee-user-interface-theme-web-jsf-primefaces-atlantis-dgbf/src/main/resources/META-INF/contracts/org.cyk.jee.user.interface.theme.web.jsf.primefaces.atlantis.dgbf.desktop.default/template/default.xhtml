<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"   
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pa="http://primefaces.org/atlantis"
      xmlns:cyk="http://primefaces.jsf.web.utility.cyk.org">

    <f:metadata>
  		<cyk:contractMetadata/>
	</f:metadata>
	
    <h:head>
    	<cyk:contractHead/>
    </h:head>
    
	<h:body styleClass="main-body">
		<cyk:contractBody>
			<ui:define name="contractBodyWithTheme">
				<cyk:contractBodyWithThemeBeforeFormTag/>
								
				<cyk:contractBodyWithThemeInsideFormTag>					
					<!-- Override to move it in the form tag -->
					<ui:define name="contractBodyWithThemeInsideFormTagBodyFirst"/>
					
					<ui:define name="contractBodyWithThemeInsideFormTagBodySecond">
						<div class="layout-wrapper">
							<ui:fragment rendered="#{not __page__.isRenderTypeDialog}">
								 <ui:insert name="menuTop">
					            	<!--
					            	<p:cache region="#{__page__.sessionUser.identifier == null ? 'TOP_BAR' : __page__.sessionUser.identifier}">
					            	-->
					            		<ui:include src="topbar.xhtml" />
					            	<!--
					            	</p:cache>
					            	-->
					            </ui:insert>
							</ui:fragment>
					        
					        <ui:fragment rendered="#{not __page__.isRenderTypeDialog}">   				            
					            <ui:insert name="menuLeft">
						            <div class="layout-sidebar">
						            	<ui:insert name="menuLeftTabs">
						            		<ui:include src="menuLeftTabs.xhtml"/>
						            	</ui:insert>
					       			</div>
					            </ui:insert>
				            </ui:fragment>
				            
				            <div class="layout-main" id="contenu" style="#{__page__.isRenderTypeDialog ? 'margin : 0px;padding : 0px;' : ''}">
				                <div class="layout-main-content">
				                	<ui:insert name="__internalLog">
				                		<ui:fragment rendered="#{__page__.__isInternalLoggable__}">
				                			<h:outputText value="Page build duration : #{__page__.__windowBuildDuration__}" />
				                		</ui:fragment>
				                	</ui:insert>
				                	<cyk:form value="#{__page__.window.theme.tagMap.get('content.form')}">
				                		<ui:define name="formContent">
					                		<cyk:contractBodyWithThemeInsideFormTagBodyFirst/>
					                	
					                		<ui:insert name="center">
												<ui:insert name="centerNorth">
													<div class="ui-g-12 cyk-page-form-content-messages">
														<cyk:contractBodyMessages/>
													</div>
												</ui:insert>
												
												<!--
												<p:outputPanel id="formCenterCenterOutputPanel">
												-->
													<p:outputPanel deferred="#{__page__.contentOutputPanel.deferred}" deferredMode="#{__page__.contentOutputPanel.deferredMode}">
														<ui:insert name="centerCenter">
															<c:set var="viewCenter" value="#{theme.viewMap.get('center')}" />
															<c:if test="#{viewCenter != null}">
																<div class="ui-g-12">
																	<ui:insert name="centerView">
																		<cyk:view value="#{viewCenter}" />
																	</ui:insert>
																</div>
															</c:if>
														</ui:insert>
													</p:outputPanel>														
												<!--
												</p:outputPanel>
												-->	
					                		</ui:insert>
				                		</ui:define>
				                	</cyk:form>		                			
				                </div>
				            </div>
				        </div>
					</ui:define>
				</cyk:contractBodyWithThemeInsideFormTag>
				
				<cyk:contractBodyWithThemeAfterFormTag/>
			</ui:define>
		</cyk:contractBody>
		<h:outputStylesheet library="css" name="cyk.css"/>
    </h:body>
</html>